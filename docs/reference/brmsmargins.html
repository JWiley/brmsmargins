<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate Average Marginal Effects (AMEs) from brms models — brmsmargins • brmsmargins</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate Average Marginal Effects (AMEs) from brms models — brmsmargins" />
<meta property="og:description" content="This function is designed to help calculate average marginal
effects (AMEs) from brms models.
Currently, only one of at or add can be specified.
It is hoped to relax this in the future.
TODO add more documentation and technical definitions." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brmsmargins</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate Average Marginal Effects (AMEs) from brms models</h1>
    
    <div class="hidden name"><code>brmsmargins.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is designed to help calculate average marginal
effects (AMEs) from brms models.
Currently, only one of <code>at</code> or <code>add</code> can be specified.
It is hoped to relax this in the future.
TODO add more documentation and technical definitions.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>brmsmargins</span><span class='op'>(</span>
  <span class='va'>object</span>,
  at <span class='op'>=</span> <span class='cn'>NULL</span>,
  add <span class='op'>=</span> <span class='cn'>NULL</span>,
  newdata <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.frame.html'>model.frame</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>,
  CI <span class='op'>=</span> <span class='fl'>0.99</span>,
  CIType <span class='op'>=</span> <span class='st'>"HDI"</span>,
  contrasts <span class='op'>=</span> <span class='cn'>NULL</span>,
  ROPE <span class='op'>=</span> <span class='cn'>NULL</span>,
  MID <span class='op'>=</span> <span class='cn'>NULL</span>,
  subset <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A fitted brms model object. Required.</p></td>
    </tr>
    <tr>
      <th>at</th>
      <td><p>An optional object inheriting from data frame indicating
the values to hold specific variables at when calculating average
predictions. This is intended for AMEs from categorical variables.</p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>An optional object inheriting from data frame indicating
the values to add to specific variables at when calculating average
predictions. This is intended for AMEs for continuous variables.</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>An object inheriting from data frame indicating
the baseline values to use for predictions and AMEs.
Defaults to be the model frame.</p></td>
    </tr>
    <tr>
      <th>CI</th>
      <td><p>A numeric value specifying the width of the credible interval.
Defaults to <code>0.99</code>.</p></td>
    </tr>
    <tr>
      <th>CIType</th>
      <td><p>A character string specifying the type of credible interval
(e.g., highest density interval). It is passed down to
<code><a href='bsummary.html'>bsummary</a></code> which in turn passes it to
<code><a href='https://easystats.github.io/bayestestR/reference/ci.html'>ci</a></code>. Defaults to &#8220;HDI&#8221;.</p></td>
    </tr>
    <tr>
      <th>contrasts</th>
      <td><p>An optional contrast matrix. The posterior predictions matrix
is post multiplied by the contrast matrix, so they must be conformable.
The posterior predictions matrix has a separate column for each row in the
<code>at</code> or <code>add</code> object, so the contrast matrix should have the same
number of rows. It can have multiple columns, if you desire multiple specific
contrasts.</p></td>
    </tr>
    <tr>
      <th>ROPE</th>
      <td><p>Either left as <code>NULL</code>, the default, or a numeric vector of
length 2, specifying the lower and upper thresholds for the
Region of Practical Equivalence (ROPE).</p></td>
    </tr>
    <tr>
      <th>MID</th>
      <td><p>Either left as <code>NULL</code>, the default, or a numeric vector of
length 2, specifying the lower and upper thresholds for a
Minimally Important Difference (MID). Unlike the ROPE, percentages for
the MID are calculated as at or exceeding the bounds specified by this
argument, whereas the ROPE is the percentage of the posterior at or inside
the bounds specified.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>A character string that is a valid <code>R</code> expression
used to subset the dataset passed in <code>newdata</code>,
prior to analysis. Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed on to <code><a href='dot-predict.html'>.predict</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list. TODO describe more.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='co'># \dontrun{</span></span>
<span class='r-in'><span class='co'>#### Testing ####</span></span>
<span class='r-in'><span class='co'>## sample data and logistic model with brms</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>Tx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span>, each <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>ybin</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>40</span>,<span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>40</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>logitd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Tx <span class='op'>=</span> <span class='va'>Tx</span>, ybin <span class='op'>=</span> <span class='va'>ybin</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>logitd</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, mean <span class='op'>=</span> <span class='va'>logitd</span><span class='op'>$</span><span class='va'>ybin</span>, sd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>mbin</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='va'>ybin</span> <span class='op'>~</span> <span class='va'>Tx</span> <span class='op'>+</span> <span class='va'>x</span>, data <span class='op'>=</span> <span class='va'>logitd</span>, family <span class='op'>=</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsfamily.html'>bernoulli</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Compiling Stan program...</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Start sampling</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> SAMPLING FOR MODEL 'fd9b113038d6c3d015532b47d187dbe5' NOW (CHAIN 1).</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Gradient evaluation took 0 seconds</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1:  Elapsed Time: 0.037 seconds (Warm-up)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1:                0.039 seconds (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1:                0.076 seconds (Total)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 1: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> SAMPLING FOR MODEL 'fd9b113038d6c3d015532b47d187dbe5' NOW (CHAIN 2).</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Gradient evaluation took 0 seconds</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Adjust your expectations accordingly!</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2:  Elapsed Time: 0.037 seconds (Warm-up)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2:                0.031 seconds (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2:                0.068 seconds (Total)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 2: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> SAMPLING FOR MODEL 'fd9b113038d6c3d015532b47d187dbe5' NOW (CHAIN 3).</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Gradient evaluation took 0 seconds</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Adjust your expectations accordingly!</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3:  Elapsed Time: 0.035 seconds (Warm-up)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3:                0.039 seconds (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3:                0.074 seconds (Total)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 3: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> SAMPLING FOR MODEL 'fd9b113038d6c3d015532b47d187dbe5' NOW (CHAIN 4).</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Gradient evaluation took 0 seconds</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Adjust your expectations accordingly!</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4:  Elapsed Time: 0.036 seconds (Warm-up)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4:                0.031 seconds (Sampling)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4:                0.067 seconds (Total)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Chain 4: </span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mbin</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  Family: bernoulli </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Links: mu = logit </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Formula: ybin ~ Tx + x </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    Data: logitd (Number of observations: 100) </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>          total post-warmup draws = 4000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Population-Level Effects: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Intercept    -1.28      0.38    -2.09    -0.58 1.00     4352     2969</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Tx            2.51      0.54     1.48     3.60 1.00     4105     2865</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> x             0.38      0.14     0.11     0.67 1.00     3580     3061</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> and Tail_ESS are effective sample size measures, and Rhat is the potential</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> scale reduction factor on split chains (at convergence, Rhat = 1).</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## predictions + summary </span></span>
<span class='r-in'><span class='va'>test1</span> <span class='op'>&lt;-</span> <span class='fu'>brmsmargins</span><span class='fu'>:::</span><span class='fu'><a href='dot-predict.html'>.predict</a></span><span class='op'>(</span><span class='va'>mbin</span>,</span>
<span class='r-in'>         <span class='fu'><a href='https://rdrr.io/r/stats/model.frame.html'>model.frame</a></span><span class='op'>(</span><span class='va'>mbin</span><span class='op'>)</span>,</span>
<span class='r-in'>         summarize <span class='op'>=</span> <span class='cn'>TRUE</span>, posterior <span class='op'>=</span> <span class='cn'>FALSE</span>, dpar <span class='op'>=</span> <span class='cn'>NULL</span>, re_formula <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span class='r-in'>         resample <span class='op'>=</span> <span class='fl'>0L</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>test1</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $Summary</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>            M      Mdn        LL        UL PercentROPE PercentMID   CI CIType</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: 0.5002456 0.500962 0.4049813 0.6023425          NA         NA 0.99    HDI</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    ROPE  MID</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: &lt;NA&gt; &lt;NA&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## check that bootstrapping the sample / population assumed as part of the</span></span>
<span class='r-in'><span class='co'>## AME indeed increases the uncertainty interval</span></span>
<span class='r-in'><span class='co'>## TODO: point estimates (M, Mdn) should be based on the actual data</span></span>
<span class='r-in'><span class='co'>## not the bootstrapped</span></span>
<span class='r-in'><span class='va'>test2</span> <span class='op'>&lt;-</span> <span class='fu'>brmsmargins</span><span class='fu'>:::</span><span class='fu'><a href='dot-predict.html'>.predict</a></span><span class='op'>(</span><span class='va'>mbin</span>,</span>
<span class='r-in'>         <span class='fu'><a href='https://rdrr.io/r/stats/model.frame.html'>model.frame</a></span><span class='op'>(</span><span class='va'>mbin</span><span class='op'>)</span>,</span>
<span class='r-in'>         summarize <span class='op'>=</span> <span class='cn'>TRUE</span>, posterior <span class='op'>=</span> <span class='cn'>FALSE</span>, dpar <span class='op'>=</span> <span class='cn'>NULL</span>, re_formula <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span class='r-in'>         resample <span class='op'>=</span> <span class='fl'>100L</span>, seed <span class='op'>=</span> <span class='fl'>1234</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>test2</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $Summary</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>            M       Mdn        LL        UL PercentROPE PercentMID   CI CIType</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: 0.5001863 0.5005524 0.3716074 0.6278819          NA         NA 0.99    HDI</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    ROPE  MID</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: &lt;NA&gt; &lt;NA&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## now check AME for Tx</span></span>
<span class='r-in'><span class='va'>tmp</span> <span class='op'>&lt;-</span> <span class='fu'>brmsmargins</span><span class='op'>(</span></span>
<span class='r-in'>  object <span class='op'>=</span> <span class='va'>mbin</span>,</span>
<span class='r-in'>  at <span class='op'>=</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span>Tx <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>  contrasts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>  ROPE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.05</span>, <span class='op'>+</span><span class='fl'>.05</span><span class='op'>)</span>,</span>
<span class='r-in'>  MID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.10</span>, <span class='op'>+</span><span class='fl'>.10</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>tmp</span><span class='op'>$</span><span class='va'>Summary</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>            M       Mdn        LL        UL PercentROPE PercentMID   CI CIType</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: 0.2608257 0.2597441 0.1130868 0.4352608           0      99.65 0.99    HDI</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2: 0.7491560 0.7523842 0.5769914 0.8966183           0     100.00 0.99    HDI</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>             ROPE                       MID</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: [-0.05, 0.05] [-Inf, -0.1] | [0.1, Inf]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2: [-0.05, 0.05] [-Inf, -0.1] | [0.1, Inf]</span>
<span class='r-in'><span class='va'>tmp</span><span class='op'>$</span><span class='va'>ContrastSummary</span> <span class='co'>## Tx AME</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>            M       Mdn        LL        UL PercentROPE PercentMID   CI CIType</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: 0.4883303 0.4884615 0.2436184 0.7196581           0        100 0.99    HDI</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>             ROPE                       MID</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: [-0.05, 0.05] [-Inf, -0.1] | [0.1, Inf]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## now check AME for Tx with bootstrapping the AME population</span></span>
<span class='r-in'><span class='va'>tmpalt</span> <span class='op'>&lt;-</span> <span class='fu'>brmsmargins</span><span class='op'>(</span></span>
<span class='r-in'>  object <span class='op'>=</span> <span class='va'>mbin</span>,</span>
<span class='r-in'>  at <span class='op'>=</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span>Tx <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>  contrasts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>  ROPE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.05</span>, <span class='op'>+</span><span class='fl'>.05</span><span class='op'>)</span>,</span>
<span class='r-in'>  MID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.10</span>, <span class='op'>+</span><span class='fl'>.10</span><span class='op'>)</span>,</span>
<span class='r-in'>  resample <span class='op'>=</span> <span class='fl'>100L</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>tmpalt</span><span class='op'>$</span><span class='va'>Summary</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>            M       Mdn        LL        UL PercentROPE PercentMID   CI CIType</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: 0.2607922 0.2585965 0.1017346 0.4346288           0     99.645 0.99    HDI</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2: 0.7491551 0.7529014 0.5710419 0.8969755           0    100.000 0.99    HDI</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>             ROPE                       MID</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: [-0.05, 0.05] [-Inf, -0.1] | [0.1, Inf]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2: [-0.05, 0.05] [-Inf, -0.1] | [0.1, Inf]</span>
<span class='r-in'><span class='va'>tmpalt</span><span class='op'>$</span><span class='va'>ContrastSummary</span> <span class='co'>## Tx AME</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>            M       Mdn        LL        UL PercentROPE PercentMID   CI CIType</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: 0.4883628 0.4901685 0.2332385 0.7235288           0    99.9905 0.99    HDI</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>             ROPE                       MID</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: [-0.05, 0.05] [-Inf, -0.1] | [0.1, Inf]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## now check AME for continuous predictor, x</span></span>
<span class='r-in'><span class='co'>## use .01 as an approximation for first derivative</span></span>
<span class='r-in'><span class='co'>## 1 / .01 in the contrast matrix to get back to a one unit change metric</span></span>
<span class='r-in'><span class='va'>tmp2</span> <span class='op'>&lt;-</span> <span class='fu'>brmsmargins</span><span class='op'>(</span></span>
<span class='r-in'>  object <span class='op'>=</span> <span class='va'>mbin</span>,</span>
<span class='r-in'>  add <span class='op'>=</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.01</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span class='r-in'>  contrasts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>.01</span>, <span class='fl'>1</span><span class='op'>/</span><span class='fl'>.01</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>  ROPE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.05</span>, <span class='op'>+</span><span class='fl'>.05</span><span class='op'>)</span>,</span>
<span class='r-in'>  MID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.10</span>, <span class='op'>+</span><span class='fl'>.10</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>tmp2</span><span class='op'>$</span><span class='va'>ContrastSummary</span> <span class='co'>## x AME</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>             M        Mdn          LL         UL PercentROPE PercentMID   CI</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1: 0.05310642 0.05348044 0.005255614 0.09772485      42.675        0.4 0.99</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    CIType          ROPE                       MID</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1:    HDI [-0.05, 0.05] [-Inf, -0.1] | [0.1, Inf]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/lme4/lme4/'>lme4</a></span><span class='op'>)</span></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>sleepstudy</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='va'>Reaction</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='va'>Days</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span> <span class='va'>Days</span> <span class='op'>|</span> <span class='va'>Subject</span><span class='op'>)</span>, </span>
<span class='r-in'>             data <span class='op'>=</span> <span class='va'>sleepstudy</span>,</span>
<span class='r-in'>             cores <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span> </span>
<span class='r-in'></span>
<span class='r-in'>  <span class='va'>tmp</span> <span class='op'>&lt;-</span> <span class='fu'>brmsmargins</span><span class='op'>(</span></span>
<span class='r-in'>    object <span class='op'>=</span> <span class='va'>fit</span>,</span>
<span class='r-in'>    at <span class='op'>=</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span>Days <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>    contrasts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>    ROPE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.05</span>, <span class='op'>+</span><span class='fl'>.05</span><span class='op'>)</span>,</span>
<span class='r-in'>    MID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.10</span>, <span class='op'>+</span><span class='fl'>.10</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='va'>tmp</span><span class='op'>$</span><span class='va'>Summary</span></span>
<span class='r-in'>  <span class='va'>tmp</span><span class='op'>$</span><span class='va'>ContrastSummary</span></span>
<span class='r-in'>  <span class='op'>}</span></span>
<span class='r-in'><span class='co'># }</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Joshua F. Wiley.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


