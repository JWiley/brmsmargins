<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Calculate marginal estimates and average marginal effects for brms • brmsmargins</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="preferably.css">
<link id="css-code-light" rel="stylesheet" href="code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Calculate marginal estimates and average marginal effects for brms">
<meta property="og:description" content="Used as a follow-up to a brms model, to calculate marginal estimates and
  average marginal effects (AMEs). This is a supplement as existing packages,
  such as emmeans calculate marginal effects at the means (MEMs) and not AMEs.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">brmsmargins</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/fixed-effects-marginaleffects.html">Marginal Effects for Fixed Effects Models</a>
    </li>
    <li>
      <a href="articles/mixed-effects-marginaleffects.html">Marginal Effects for Mixed Effects Models</a>
    </li>
    <li>
      <a href="articles/location-scale-marginaleffects.html">Marginal Effects for Location Scale Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JWiley/brmsmargins/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
        
        


      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>This package has functions to calculate marginal effects from <code>brms</code> models ( <a href="http://paul-buerkner.github.io/brms/" class="uri">http://paul-buerkner.github.io/brms/</a> ). A central motivator is to calculate average marginal effects (AMEs) for continuous and discrete predictors in fixed effects only and mixed effects regression models including location scale models.</p>
<p>This table shows an overview of currently supported models / features where “X” indicates a specific model / feature is currently supported. The column ‘Fixed’ means fixed effects only models. The column ‘Mixed’ means mixed effects models.</p>
<table class="table">
<thead><tr class="header">
<th>Distribution / Feature</th>
<th>Fixed</th>
<th>Mixed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Gaussian / Normal</td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
</tr>
<tr class="even">
<td>Bernoulli (logistic)</td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
</tr>
<tr class="even">
<td>Negative Binomial</td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
</tr>
<tr class="odd">
<td>Gamma</td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr>
<tr class="even">
<td>Beta</td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr>
<tr class="odd">
<td>Multinomial logistic</td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr>
<tr class="even">
<td>Multivariate models</td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr>
<tr class="odd">
<td>Gaussian location scale models</td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
</tr>
<tr class="even">
<td>Natural log / square root transformed outcomes</td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
</tr>
<tr class="odd">
<td>Monotonic predictors</td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
<td><span class="emoji" data-emoji="heavy_check_mark">✔️</span></td>
</tr>
<tr class="even">
<td>Custom outcome transformations</td>
<td><span class="emoji" data-emoji="x">❌</span></td>
<td><span class="emoji" data-emoji="x">❌</span></td>
</tr>
</tbody>
</table>
<p>In general, any distribution supported by <code>brms</code> that generates one and only one predicted value (e.g., not multinomial logistic regression models) should be supported for fixed effects only models. Also note that currently, only Gaussian random effects are supported. This is not too limiting as even for Bernoulli, Poisson, etc. outcomes, the random effects are commonly assumed to have a Gaussian distribution.</p>
<p>Here is a quick syntax overview of how to use the main function, <code><a href="reference/brmsmargins.html">brmsmargins()</a></code>.</p>
<div id="fixed-effects-continuous-predictor" class="section level4">
<h4 class="hasAnchor">
<a href="#fixed-effects-continuous-predictor" class="anchor"></a>Fixed effects, continuous predictor.</h4>
<pre><code>h &lt;- .001
ames &lt;- brmsmargins(
  object = model,
  add = data.frame(x = c(0, h)),
  contrasts = cbind("AME x" = c(-1 / h, 1 / h)),
  effects = "fixedonly")
  
ames$ContrastSummary</code></pre>
</div>
<div id="fixed-effects-discrete-predictor" class="section level4">
<h4 class="hasAnchor">
<a href="#fixed-effects-discrete-predictor" class="anchor"></a>Fixed effects, discrete predictor.</h4>
<pre><code>ames &lt;- brmsmargins(
  object = model,
  add = data.frame(x = c(0, 1)),
  contrasts = cbind("AME x" = c(-1, 1)),
  effects = "fixedonly")

ames$Summary
ames$ContrastSummary</code></pre>
</div>
<div id="mixed-effects-continuous-predictor" class="section level4">
<h4 class="hasAnchor">
<a href="#mixed-effects-continuous-predictor" class="anchor"></a>Mixed effects, continuous predictor.</h4>
<pre><code>h &lt;- .001
ames &lt;- brmsmargins(
  object = model,
  add = data.frame(x = c(0, h)),
  contrasts = cbind("AME x" = c(-1 / h, 1 / h)),
  effects = "integrateoutRE")
  
ames$ContrastSummary</code></pre>
</div>
<div id="mixed-effects-discrete-predictor" class="section level4">
<h4 class="hasAnchor">
<a href="#mixed-effects-discrete-predictor" class="anchor"></a>Mixed effects, discrete predictor.</h4>
<pre><code>ames &lt;- brmsmargins(
  object = model,
  add = data.frame(x = c(0, 1)),
  contrasts = cbind("AME x" = c(-1, 1)),
  effects = "integrateoutRE")

ames$Summary
ames$ContrastSummary</code></pre>
</div>
<div id="mixed-effects-location-scale-continuous-predictor" class="section level4">
<h4 class="hasAnchor">
<a href="#mixed-effects-location-scale-continuous-predictor" class="anchor"></a>Mixed Effects Location Scale, continuous predictor</h4>
<pre><code>h &lt;- .001
ames &lt;- brmsmargins(
  object = model,
  add = data.frame(x = c(0, h)),
  contrasts = cbind("AME x" = c(-1 / h, 1 / h)),
  dpar = "sigma",
  effects = "integrateoutRE")
  
ames$ContrastSummary</code></pre>
</div>
<div id="mixed-effects-location-scale-discrete-predictor" class="section level4">
<h4 class="hasAnchor">
<a href="#mixed-effects-location-scale-discrete-predictor" class="anchor"></a>Mixed Effects Location Scale, discrete predictor</h4>
<pre><code>ames &lt;- brmsmargins(
  object = model,
  at = data.frame(x = c(0, 1)),
  contrasts = cbind("AME x" = c(-1, 1)),
  dpar = "sigma",
  effects = "integrateoutRE")

ames$Summary
ames$ContrastSummary</code></pre>
<p>Note that even on mixed effects models, it is possible to generate predictions and marginal effects from the fixed effects only, just by specifying <code>effects = "fixedonly"</code> but this is probably not a good idea generally so not shown by default.</p>
<p>Also note that for all of these examples <code>ames$Summary</code> would have a summary of the averaged predicted values. These often are useful for discrete predictors. For continuous predictors, if the focus is on marginal effects, they often are not interesting. However, the <code>at</code> argument can be used with continuous predictors to generate interesting averaged predicted values. For example, this would get predicted values integrating out random effects for a range of ages averaging (marginalizing) all other predictors / covariates.</p>
<pre><code>ames &lt;- brmsmargins(
  object = model,
  at = data.frame(age = c(20, 30, 40, 50, 60)),
  effects = "integrateoutRE")

ames$Summary</code></pre>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The package is not yet on CRAN, so to install, you must use the development version. To install, run:</p>
<pre><code>devtools::install_github("JWiley/brmsmargins")</code></pre>
</div>
<div id="learn-more" class="section level2">
<h2 class="hasAnchor">
<a href="#learn-more" class="anchor"></a>Learn More</h2>
<p>There are three vignettes that introduce how to use the package for several scenarios.</p>
<ul>
<li>
<a href="https://joshuawiley.com/brmsmargins/articles/fixed-effects-marginaleffects.html">Fixed effects only models</a> (also called single level models). This also is the best place to start learning about how to use the package. It includes a brief amount of motivation for why we would want to calculate marginal effects at all.</li>
<li>
<a href="https://joshuawiley.com/brmsmargins/articles/mixed-effects-marginaleffects.html">Mixed effects models</a> (also called multilevel models). This shows how to calculate marginal effects for mixed effects / multilevel models. There are runnable examples, but not much background.</li>
<li>
<a href="https://joshuawiley.com/brmsmargins/articles/location-scale-marginaleffects.html">Location scale models</a>. Location scale models are models where both the location (e.g., mean) and scale (e.g., variance / residual standard deviation) are explicitly modeled as outcomes. These require use of distributional parameters <code>dpar</code> in <code>brms</code>. This vignette shows how to calculate marginal effects from location scale models for the scale part.</li>
</ul>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/JWiley/brmsmargins/">https://​github.com/​JWiley/​brmsmargins/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/JWiley/brmsmargins/issues">https://​github.com/​JWiley/​brmsmargins/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Joshua F. Wiley <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0271-6702" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://codecov.io/gh/JWiley/brmsmargins?branch=main"><img src="https://codecov.io/gh/JWiley/brmsmargins/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Joshua F. Wiley.</p>
</div>

<div class="pkgdown">
  <p>Made with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1, using <a href="https://preferably.amirmasoudabdol.name/?source=footer">preferably</a> template.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
